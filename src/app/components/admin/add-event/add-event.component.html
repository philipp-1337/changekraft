<div class="container pb-3">
  <div class="row">
    <div class="col-12 mt-3">
      <mat-card>
        <form [formGroup]="eventForm">
          <mat-card-header>
            <div class="justify-content-center align-self-center" mat-card-avatar>
              <mat-icon
                svgIcon="event"
                style="font-size: 40px; height: 40px; width: 40px;"></mat-icon>
            </div>
            <mat-card-title>Event hinzufügen</mat-card-title>
            <mat-card-subtitle class="mb-0">Hier kannst du dein Event erstellen</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content class="mt-3">
            <p>
              <mat-form-field class="full-width">
                <input
                  matInput
                  type="text"
                  color="accent"
                  id="name"
                  formControlName="name"
                  placeholder="Name"
                  class="form-control"
                  required>
                  <mat-hint *ngIf="eventForm.controls['name'].touched && !eventForm.controls['name'].valid">
                    Das darf nicht leer sein.
                  </mat-hint>
              </mat-form-field>
            </p>
            <p>
              <mat-form-field class="full-width" [ngClass]="{'mat-form-field-invalid': !urlAvailable}">
                <input
                  matInput
                  type="text"
                  color="accent"
                  id="url"
                  formControlName="url"
                  placeholder="URL"
                  class="form-control"
                  required>
                  <mat-hint *ngIf="eventForm.controls['url'].touched && !eventForm.controls['url'].valid">
                    Das darf nicht leer sein.
                  </mat-hint>
                  <mat-hint *ngIf="!urlAvailable">
                    Diese URL ist leider nicht mehr verfügbar.
                  </mat-hint>
              </mat-form-field>
            </p>
            <p>
              <mat-form-field class="full-width">
                <textarea
                  matInput
                  type="text"
                  color="accent"
                  id="desc"
                  formControlName="desc"
                  placeholder="Beschreibung"
                  class="form-control"
                  required>
                </textarea>
              </mat-form-field>
            </p>
          </mat-card-content>
          <mat-card-actions>
            <button
            mat-button
            type="button"
            title="Speichern"
            (click)="onSave(eventForm)"
            [disabled]="eventForm.invalid || !eventForm.controls['url'].touched || !urlAvailable">
              <span>Speichern</span>
            </button>
          </mat-card-actions>
        </form>
      </mat-card>

      <mat-card *ngIf="!(event$ | async)" class="mt-3">
        <mat-card-content>
          <mat-progress-bar mode="query"></mat-progress-bar>
        </mat-card-content>
      </mat-card>
      <mat-card *ngIf="(event$ | async)" class="mt-3">
        <mat-card-header>
          <div class="justify-content-center align-self-center" mat-card-avatar>
            <mat-icon
              svgIcon="supervisor_account"
              style="font-size: 40px; height: 40px; width: 40px;"></mat-icon>
          </div>
          <mat-card-title>Übersicht</mat-card-title>
          <mat-card-subtitle class="mb-0">Alle Events</mat-card-subtitle>
        </mat-card-header>
      </mat-card>
      <mat-accordion class="headers-align">
        <div class="mt-3">
          <mat-expansion-panel *ngFor="let event of event$ | async; let ievent = index">
            <mat-expansion-panel-header>
              <mat-panel-title>
                {{ event?.name }}
              </mat-panel-title>
              <mat-panel-description>
                {{ event?.desc }}
              </mat-panel-description>
            </mat-expansion-panel-header>
              <ul>
                <li class="mb-1">Beschreibung: {{ event?.desc }}</li>
                <li class="mb-1">Event: {{ event?.name }}</li>
                <a
                  style="cursor: pointer"
                  [routerLink]="['../../event/' + event?.url]"
                  routerLinkActive="active">Zum Event</a>
              </ul>
              <!-- <mat-action-row>
                <button mat-button *ngIf="!editMode" color="primary" (click)="editMode = !editMode" title="Teilnehmer bearbeiten">
                  <mat-icon svgIcon="edit"></mat-icon>
                </button>
                <button
                  mat-button
                  *ngIf="editMode"
                  color="primary"
                  (click)="editMode = !editMode; updateItem(participant.id, begleitung.checked)"
                  title="Teilnehmer bearbeiten">
                  <mat-icon svgIcon="save"></mat-icon>
                </button>
                <a
                  *ngIf="participant?.email"
                  mat-button
                  color="primary"
                  href="mailto:{{participant?.email}}"
                  target="_blank"
                  title="E-Mail schreiben">
                  <mat-icon svgIcon="email"></mat-icon>
                </a>
                <button mat-button color="warn" (click)="openDialog(participant.id, participant.name)" title="Teilnehmer entfernen">
                  <mat-icon svgIcon="delete"></mat-icon>
                </button>
              </mat-action-row> -->
          </mat-expansion-panel>
        </div>
      </mat-accordion>

      <!-- <mat-card class="mt-3" *ngIf="(event$ | async)">
        <button
          mat-flat-button
          color="primary"
          (click)="exportAsXLSX()"
          matBadge="{{ counter }}"
          matBadgePosition="above after"
          matBadgeColor="accent">
          Excel Download
        </button>
      </mat-card> -->
    </div>
  </div>
</div>
